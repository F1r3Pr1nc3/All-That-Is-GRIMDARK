
namespace = grimstart
# (on_game_start_country)
country_event = {
	id = grimstart.10
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		merg_is_default_empire = yes
	}

	immediate = {
		if = { # 2 Setup Shroud Rage
			limit = {
				OR = {
					has_origin = origin_shroudrage
					has_country_flag = khorne
					is_species = PRESCRIPTED_species_name_khorne
				}
			}
			owner_main_species = {
				if = {
					limit = {
						NOT = { has_trait = trait_pc_nuked_preference }
					}
					change_species_characteristics = { add_trait = trait_pc_nuked_preference }
				}
				if = {
					limit = {
						NOT = { has_trait = trait_survivor }
					}
					change_species_characteristics = { add_trait = trait_survivor }
				}
			}
			if = { # Compare with prescipted empire design
				limit = {
					host_has_dlc = "Apocalypse"
					NOT = { has_civic = civic_barbaric_despoilers }
				}
				# force_add_civic = civic_barbaric_despoilers
				change_government = {
					civics = { civic = civic_barbaric_despoilers }
					remove_invalid_civics = yes
				}
			}
			country_event = { id = grimstart.2 }
		}
		else_if = { # 3 Setup Shroud Mutated
			limit = {
				OR = {
					has_origin = origin_shroudmutated
					has_country_flag = tzeentch
					is_species = "Tzeentick"
				}
			}
			give_technology = { message = yes tech = tech_psionic_theory }		# Tier 3
			give_technology = { message = no tech = tech_telepathy }
			set_country_flag = breached_shroud
			if = {
				limit = { exists = event_target:capital_planet }
				event_target:capital_planet = {
					create_pop_group = {
						species = owner_species
						ethos = {
							ethic = ethic_xenophobe
							ethic = ethic_militarist
						}
					}
					add_district_and_planet_size_if_needed_effect = {
						district = district_city
					}
					remove_building = building_research_lab_1
					add_building = building_holo_theatres
					add_building = building_factory_1
				}
			}
			add_resource = { energy = 1000 }
			country_event = { id = utopia.2656 days = 2 }
			set_country_flag = chaos_empire
			set_country_flag = tzeentch
			country_event = { id = aagrimstarts.2001 days = 10 } # Updated Relations
		}
		else_if = { # 4 Setup Shroud Sick
			limit = {
				OR = {
					has_shroudsick_origin = yes # has_country_flag = nurgle
					is_species = "Nurglen"
				}
			}
			give_technology = { tech = tech_genome_mapping message = yes }				# Tier 1
			# give_tech_no_error_effect = { TECH = tech_society_1 MESSAGE = yes }		# Tier 2
			# give_tech_no_error_effect = { TECH = tech_society_2 MESSAGE = yes }		# Tier 3
			give_technology = { message = no tech = tech_gene_tailoring }				# Tier 3
			give_technology = { message = no tech = tech_glandular_acclimation }
			give_technology = { message = no tech = tech_gene_seed_purification }
			give_technology = { message = no tech = tech_exotic_gases }
			# if = {
			# 	limit = { is_gestalt = no }
			if = {
				limit = { has_necroids = yes } # is_reanimator = no
				if = {
					limit = {
						# is_ai = yes
						NOR = {
							owner_main_species = {
								OR = {
									has_trait = trait_necrophage
									has_trait = trait_plantoid_budding
									has_trait = trait_lithoid_budding
									has_trait = trait_advanced_budding
									has_trait = trait_tiyanki
								}
							}
							is_xenophile = yes
							has_ethic = ethic_fanatic_egalitarian
							# is_death_cult_empire = yes
							has_civic = civic_hive_empath
							has_civic = civic_permanent_employment
						}
					}
					owner_main_species = {
						change_species_characteristics = {
							add_trait = trait_necrophage
							can_change_leader = yes
						}
					}
				}
				if = {
					limit = {
						NOR = {
							is_reanimator = yes
							is_pacifist = yes
						}
					}
					force_add_civic = civic_reanimated_armies
				}
				set_origin = origin_necrophage
			}
			owner_main_species = {
				if = {
					limit = {
						NOT = { has_trait = trait_shroud_sick }
					}
					change_species_characteristics = {
						add_trait = trait_shroud_sick
						add_traits_at_start_of_list = yes
					}
				}
			}
			# }
			if = {
				limit = { exists = event_target:capital_planet }
				event_target:capital_planet = {
					add_building = building_hive_major_capital_sick
					add_building = building_hive_node_sick
					add_building = building_foundry_1
					add_building = building_hive_warren_sick
					add_building = building_hive_warren_sick
					add_district = { district_type = district_generator_infected ignore_cap = yes }
					add_district = { district_type = district_mining_infected ignore_cap = yes }
					add_district = { district_type = district_farming_infected ignore_cap = yes }
					add_district = { district_type = district_generator_infected ignore_cap = yes }
					add_district = { district_type = district_mining_infected ignore_cap = yes }
					add_district = { district_type = district_farming_infected ignore_cap = yes }
					add_district = { district_type = district_hive_infected ignore_cap = yes }
					create_pop_group = {
						species = owner_species
						ethos = {
							ethic = ethic_xenophobe
							ethic = ethic_militarist
						}
					}
					solar_system = {
						random_system_planet = {
							limit = {
								is_star = no
								is_colony = no
							}
							change_pc = pc_nuked
							add_deposit = d_ore_rich_caverns
							add_deposit = d_fungal_caves
							if = {
								limit = { planet_size < 14 }
								set_planet_size = 14
							}
						}
					}
				}
			}
			set_country_flag = chaos_empire
			country_event = { id = aagrimstarts.2001 days = 10 } # relations
		}
		else_if = { # 5 Setup Shroud Sinners
			limit = {
				OR = {
					has_origin = origin_shroudsinners
					has_country_flag = slaanesh
					AND = {
						owner_main_species = { is_species_class = "Chaos_Daemons" has_trait = trait_daemons } # Compat Mod "WH species"
						exists = ruler
						ruler.species = { species_portrait = "Slaanesh19" }
					}
					owner_main_species = { is_species = Slaaneshi }
				}
			}
			if = {
				limit = { NOT = { has_origin = origin_shroudsinners } }	# Compat
				set_origin = origin_shroudsinners
			}
			give_technology = { message = yes tech = tech_psionic_theory }		# Tier 3
			give_technology = { message = no tech = tech_exotic_gases }
			give_technology = { message = no tech = tech_rare_crystals }
			give_technology = { message = no tech = tech_hyper_entertainment_forum }
			give_technology = { message = no tech = tech_paradise_dome }
			# log = "Give shroudsinners empire \\[This.GetName] $tech_subdermal_stimulation$"
			give_technology = { message = no tech = tech_subdermal_stimulation }
			set_country_flag = breached_shroud
			if = {
				limit = { exists = event_target:capital_planet }
				event_target:capital_planet = {
					create_pop_group = {
						species = owner_species
						ethos = {
							ethic = ethic_xenophobe
							ethic = ethic_militarist
						}
					}
					add_deposit = d_decrepit_dwellings
					add_district_and_planet_size_if_needed_effect = {
						district = district_farming
					}
					add_district_and_planet_size_if_needed_effect = {
						district = district_industrial
					}
					add_district_and_planet_size_if_needed_effect = {
						district = district_industrial
					}
					add_district = { district_type = district_mining ignore_cap = yes }
					add_building = building_paradise_dome
					add_building = building_hyper_entertainment_forum
					remove_building = building_factory_1
					remove_building = building_foundry_1
					remove_building = building_temple
					remove_building = building_research_lab_1
					add_building = building_crystal_plant
					add_building = building_refinery
				}
			}
			add_resource = { energy = 1000 }
			if = { # Compare with prescipted empire design
				limit = {
					NOT = { has_civic = civic_merchant_guilds }
					has_megacorp = yes
				}
				force_add_civic = civic_merchant_guilds
			}
			country_event = { id = utopia.2656 days = 2 }
			set_country_flag = chaos_empire
			country_event = { id = aagrimstarts.2001 days = 10 } # Updated relations
		}
	}
}
